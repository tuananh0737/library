<div class="home-container">
  
  <div class="content-stream">
    
    <header class="stream-header">
      <div class="header-text">
        <h1>Khám phá</h1>
        <p class="subtitle">Tìm kiếm cuốn sách yêu thích tiếp theo của bạn.</p>
      </div>
      
      <div class="search-bar">
        <i class="bi bi-search"></i>
        <input 
          type="text" 
          placeholder="Nhập tên sách hoặc tác giả..." 
          [(ngModel)]="searchQuery" 
          (input)="onSearch()">
      </div>
    </header>

    <div class="categories-scroll">
      <button 
        *ngFor="let cat of categories" 
        [class.active]="activeCategory === cat"
        (click)="filterCategory(cat)"
        class="chip">
        {{cat}}
      </button>
    </div>

    <div class="book-grid">
      <div class="book-card" 
           *ngFor="let book of filteredBooks" 
           (click)="selectBook(book)"
           [class.selected]="selectedBook?.id === book.id">
        
        <div class="card-cover">
          <img [src]="'https://placehold.co/400x600/e2e8f0/1e293b?text=' + (book.name.charAt(0) | uppercase)" alt="Cover">
          <div class="hover-overlay">
            <i class="bi bi-eye-fill"></i>
          </div>
        </div>
        
        <div class="card-info">
          <h3 class="book-title" title="{{book.name}}">{{book.name}}</h3>
          <p class="book-author">{{book.author?.fullname}}</p>
        </div>
      </div>

      <div *ngIf="filteredBooks.length === 0" class="no-results">
        <p>Không tìm thấy sách nào phù hợp.</p>
      </div>
    </div>
  </div>

  <aside class="detail-panel" *ngIf="selectedBook">
    <div class="panel-content">
      <div class="book-preview">
        <div class="large-cover">
             <img [src]="'https://placehold.co/400x600/e2e8f0/1e293b?text=' + (selectedBook.name.charAt(0) | uppercase)" alt="Cover">
        </div>
        <h2 class="detail-title">{{selectedBook.name}}</h2>
        <p class="detail-author">Tác giả: <span>{{selectedBook.author?.fullname}}</span></p>
        
        <div class="meta-tags">
          <span class="tag">{{selectedBook.genres?.name}}</span>
          <span class="tag">{{selectedBook.publishYear}}</span>
          <span class="tag">{{selectedBook.numberPage}} trang</span>
        </div>

        <button class="btn-primary-action" (click)="borrowBook(selectedBook.id)">
          Mượn Sách Ngay
        </button>
      </div>

      <div class="book-description">
        <h3>Mô tả</h3>
        <p>{{selectedBook.description || 'Chưa có mô tả cho cuốn sách này.'}}</p>
      </div>

      <div class="book-stats">
        <div class="stat-item">
          <span class="value">{{selectedBook.quantity}}</span>
          <span class="label">Còn lại</span>
        </div>
        <div class="stat-item">
          <span class="value">{{selectedBook.location?.room}}</span>
          <span class="label">Phòng</span>
        </div>
        <div class="stat-item">
          <span class="value">{{selectedBook.location?.shelf}}</span>
          <span class="label">Kệ</span>
        </div>
      </div>
    </div>
  </aside>
  
  <aside class="detail-panel empty" *ngIf="!selectedBook">
      <div class="empty-msg">Chọn một cuốn sách để xem chi tiết</div>
  </aside>

</div>